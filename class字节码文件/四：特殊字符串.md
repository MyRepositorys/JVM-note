# 字节码文件中的字符串



> ### 字节码文件中的字符串有哪些含义



> #### 全限定名

```json
什么是全限定名？
	在字节码文件中描述类或者接口的字符串名称就是全限定名，如全限定名org.lang.Object全限定名，就是org/lang/Object
	就是将包名中的"." 换为'/'
符号引用包括，
	类或接口的全限定名
	字段或者方法的简单名称
	字段或者方法的描述符
在符号引用中，类或者接口很好记，就是全限定名
但是对于字段或者方法的符号引用，什么时候指简单名称，什么时候指描述符呢？
有个特殊的时间，就是在解析的时候，需要将符号引用转换为直接引用，那么字段或者方法的符号引用都是指的是描述符
地点是：运行的常量池，运行的常量池又在方法区中，这个要记得
```



> #### 简单名称

```json
简单名称非全限定名，如org.lang.object 中有一个method, 'org.lang.Object.toString()'方法，该方法的简单名称就是'toString',
再比如说java.io.PrintStream out 属于java.lang.System类中的类变量，那么'java.io.PrintStream out'的简单名称就是'out'
简单的说，就是我们经常说的'变量名'，'方法名'
字节码文件中'类'或者'接口'没有简单名称
```



> #### 描述符

```json
描述符是干嘛的？
	描述符是从另一个角度修饰'变量'，'方法',描述符不用来修饰类或者接口
怎么修饰的？
'变量'的描述符分为两者情况；
	一：'8 中基本类型变量'的描述符 分别如下：
				'byte'		'B'
				'short'		'S'
				'int'		'I'
				'long'		'J'
				'float'		'F'
				'double'	'D'
				'char'		'C'
				'boolean'	'z'
				除了'boolean','long'	是用其他字幕代替，其它6 中都是基本类型首字母大写

	二：'引用'类型的变量的描述符，如'String str;'
		变量'str'的描述符就是 'Ljava.lang.String'，引用类型变量的描述符就是'L'+'变量类型的全限定名'

'方法'的描述符：
	如：'java.lang.String.toString()' 的描述符就是'()Ljava.lang.String'
	如：'java.lang.Strint.  int indexOf(String str)' 的描述符就是：
																'(Ljava.lang.String)I'

	'方法'的描述符的组成是一对'括号，里面是参数的描述符，括号后紧跟着返回值类型的描述符'，格式如下：
			'(argu的描述符)返回值描述符'
	返回值类型为void 的描述符是'V'

'数组'的描述符：
	基本类型数组，那就是'['+'数组类型描述符'
	二维数据：'[['+'数组类型描述符'，每一维度对应'['
```







> ### 字节码文件中的字符串的编码格式

```json
字节码文件中使用变长UTF-8 编码格式，那什么是变长UTF-8编码呢？
字符对应unicode字符集中'\u001'~'\u007f'（对应ASCII 码表中的1~127 的字符） 使用 1 byte 表示
'u\0080'~'u\07ff' 之间的字符使用 2 byte
'u\0800'~'u\ffff' 之间的字符使用 3 byte 编码，
所以说不同的字符占用不同的空间，这就是UTF-8 变长编码， 

为什么使用这种编码方案是，为了尽可能的缩减字节码文件的大小，

与UTF-8 变长对应的是定长编码方案，也就是说所有的字符都用 3 byte 表示

UTF-8 变长编码的格式什么样的呢，读取字符的时候是怎么知道，我要读取几个字节呢？
```

<img src='D:\Program Files(x86)\typora\image\utf8_1.PNG'>

```json
如上图所示，当读取字符的时候，第一个 byte 的高位是0,就知道这个字符只占据 1 byte 然后根据值转换为ASCII 字符
同理 2 byte 的字符与3 byte 的字符 如下：
```

<img src='D:\Program Files(x86)\typora\image\utf8_2.PNG'>

![1560957877004](C:\Users\Administrator.MS-201605312249\AppData\Roaming\Typora\typora-user-images\1560957877004.png)



> ### 为什么字节码文件中需要这些特殊字符串

```json
java 在加载class二进制文件的时候，才会动态链接，
什么是动态链接呢？
	就是class字节码中不存放字段，方法在内存中的布局信息，在类加载的时候从常量池获取字符，方法的符号引用，然后在类创建或者运行的时候，解析符号引用，然后翻译成直接的内容地址的引用，这就是为什么字节码文件中需要特殊字符串的原因
```

